{
  "version": 3,
  "sources": ["../../controllers/auth.ts"],
  "sourcesContent": ["import passport from \"koa-passport\";\nimport { BasicStrategy } from \"passport-http\";\nimport { RouterContext } from \"koa-router\";\n\nimport * as user from \"../models/user\";\n\nconst verifyPassword = (user: any, password: string) => {\n    return user.password === password;\n}\n\npassport.use(new BasicStrategy(async (username, password, done) => {\n    let result: any[] = [];\n    try {\n        result = await user.findByUsername(username);\n    } catch (error) {\n        console.error(`Error during authentication for user ${username}: ${error}`);\n        done(null, false);\n    }\n    if(result.length) {\n        const user = result[0];\n        if(verifyPassword(user, password)){\n            done(null, {user: user});\n        }else {\n            console.log(`Password incorrect for ${username}`);\n            done(null, false);\n        }\n    } else {\n        console.log(`No user found with username ${username}`);\n        done(null, false);\n    }\n  }));\n\nexport const basicAuth = async (ctx: RouterContext, next : any) =>{\n    await passport.authenticate(\"basic\", { session: false})(ctx, next);\n    if(ctx.status == 401){\n        ctx.body = {\n            message: 'you are not authorized'\n        };\n    } else {\n     ctx.body = {\n       message: 'you are authorized'\n     };\n    }\n}"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAqB;AACrB,2BAA8B;AAG9B,WAAsB;AAEtB,MAAM,iBAAiB,CAACA,OAAW,aAAqB;AACpD,SAAOA,MAAK,aAAa;AAC7B;AAEA,oBAAAC,QAAS,IAAI,IAAI,mCAAc,OAAO,UAAU,UAAU,SAAS;AAC/D,MAAI,SAAgB,CAAC;AACrB,MAAI;AACA,aAAS,MAAM,KAAK,eAAe,QAAQ;AAAA,EAC/C,SAAS,OAAP;AACE,YAAQ,MAAM,wCAAwC,aAAa,OAAO;AAC1E,SAAK,MAAM,KAAK;AAAA,EACpB;AACA,MAAG,OAAO,QAAQ;AACd,UAAMD,QAAO,OAAO;AACpB,QAAG,eAAeA,OAAM,QAAQ,GAAE;AAC9B,WAAK,MAAM,EAAC,MAAMA,MAAI,CAAC;AAAA,IAC3B,OAAM;AACF,cAAQ,IAAI,0BAA0B,UAAU;AAChD,WAAK,MAAM,KAAK;AAAA,IACpB;AAAA,EACJ,OAAO;AACH,YAAQ,IAAI,+BAA+B,UAAU;AACrD,SAAK,MAAM,KAAK;AAAA,EACpB;AACF,CAAC,CAAC;AAEG,MAAM,YAAY,OAAO,KAAoB,SAAc;AAC9D,QAAM,oBAAAC,QAAS,aAAa,SAAS,EAAE,SAAS,MAAK,CAAC,EAAE,KAAK,IAAI;AACjE,MAAG,IAAI,UAAU,KAAI;AACjB,QAAI,OAAO;AAAA,MACP,SAAS;AAAA,IACb;AAAA,EACJ,OAAO;AACN,QAAI,OAAO;AAAA,MACT,SAAS;AAAA,IACX;AAAA,EACD;AACJ;",
  "names": ["user", "passport"]
}
